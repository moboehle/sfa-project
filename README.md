# sfa-project

24.07.2017




## Learning spatial representations with Slow Feature Analysis

#### Project report


#### Moritz Böhle, Nelson Niemeyer
#### Advisor: Laura Bella Naumann </div>













## Abstract
Slow feature analysis (SFA) allows to extract slowly varying features from a quickly varying input signal. In this project we explored how SFA can be used to produce spatial representations similar to those found in rodent hippocampus. For this we simulated a scenario loosely based on a bat flying through a rectangular room and emulated its sensory input. Applying SFA resulted in spatial representations similar to those of grid cells and adding dependent component analysis (ICA) resulted in spatial representations similar to those of place cells.

## INTRODUCTION
Rodents possess explicit neural representations of space and their own position within an environment. Somehow their brains must extract these representations from sensory input. In this project we explored how this task might be accomplished by simulating a scenario loosely based on a bat flying through a rectangular room. Our aim was to use slow feature analysis (SFA) to produce similar spatial representations as those found in the rodent hippocampus. 

Specifically, the navigation system of rodents contains several specialised cell types. Place cells are found in in hippocampal areas CA1 and CA3 and fire when an animal is in a particular location within its environment. Grid cells are found in the enthorinal cortex and fire when an animal traverses a set of regions that are arranged in a periodic triangular array covering the entire available environment. Additional types of cells representing head orientation or spatial view are important for navigation in animals, but not directly relevant to this project.

Because processing high-dimensional visual data to produce spatial navigation would be beyond the scope of this project we simulated a simpler sensory system that is inspired by the echolocation of bats. These animals measure how long echoes of their high-frequency calls take to return to their ears to build sonic maps of their surroundings. In our simulation this process is modeled by sensors measuring the distance to the walls of the environment as the bat flies through it. We show that SFA can produce outputs of similar patterns as grid cells and if independent component analysis (ICA) is coupled also place cells. 

## METHODS
We simulated the movement by modeling the velocity via an Ornstein-Uhlenbeck process with the following ODE for the velocity:


This ODE was solved by using the Euler-Maruyama method and then integrated once more in order to obtain the position of the bat over time. We chose the set of parameters alpha (=2) and beta (=6) such that the room was quickly covered and, moreover, the trajectory was rather smooth and dominated by inertia. The temporal resolution was chosen as 0.05 units and overall we simulated the flight of the bat for 1500 units if not otherwise stated. Furthermore, we implemented a safety distance for the bat from the wall of 0.01 spatial units so as to avoid numerical issues. In order to have the bat also discover the edges of the room, we implemented an inelastic collision with the wall that had the bat lose half its velocity upon collision after mirroring the velocity along the axis perpendicular to the wall. 

The slow feature analysis as well as the other signal processing methods (whitening, polynomial expansion, etc.) were implemented by using the MDP library [Zito et al., 2009]. 

## RESULTS
Velocity modeled by Ornstein-Uhlenbeck process yields good room coverage
We implemented a random walk procedure through rectangular rooms. To decrease the time it takes to cover the entire room we modeled the movement of the bat as being generated by an Ornstein-Uhlenbeck process in the velocity. Figure 1 shows that for a long simulation time of 1500 time units the bat covers the room evenly. 

## SFA with 2 orthogonal sensors
We started by simulating a bat with only two orthogonal sensors in a rectangular room and a degree of polynomial expansion of 1. Figure 2 and 3 show the output for the SFA components as a color plot over position for an elongated room (side-to-side ratio of 2) and a square room. SFA finds a set of linear combinations of signals that is uncorrelated and ordered by the average relative velocity with which these signals change. For an elongated room, the distance to the walls on the long side is dominating in slowness, as the relative change in this signal will be smallest. Since one constraint of SFA is that the output signals are uncorrelated, the second signal will be the distance to the walls on the shorter side and, therefore, the output signals are the two principle axes up-down and left-right. As we can see in fig. 3, in a square room the SFA output signals are the diagonals. We attribute this to the fact that in this scenario the distances measured along the diagonals become uncorrelated, since they are now approximately perpendicular to each other for a large area of the room. As they also represent the longest axes, they will also yield the most slowly changing signals. Following this argumentation, we would expect the SFA output to go back to the principal axes if the bat spends more time at the edges of the room, since then the approximation of the diagonal signals being perpendicular to each other breaks down. This is indeed what happens, as can be seen in fig. 3a, which shows the SFA result for a small square room (side length 0.5) and a smaller value for alpha (1).  




## SFA with more than 2 sensors
Next, we increased the number of sensors. The number of output signals increases with the number of sensors. For a large number of sensors the signals may become linearly dependent, which is why we introduced a whitening node. This node ensures that the resulting signal has unit variance in all directions and ensures that all directions with zero variance are removed. The first two output signals of the SFA remained similar to the output signals we got in the 2-sensor case – one signal for each principal direction – and subsequent signals gave more elaborate shapes with increasingly higher spatial frequency, but without any apparent structure to them (Figure 4). 

## Varying the degree of polynomial expansion
As we increased the degree of polynomial expansion in a rectangular room with a side-to-side ratio of 2, the outputs of the SFA produce more elaborate shapes. Specifically, higher order outputs seem to divide the environment into regularly arranged regions of high and low response; the spatial frequency of these regions increases with the index of the SFA output signals. The higher the polynomial expansion of the inputs signals is, the more pronounced this division into subregions becomes as can be seen in fig. 5 in which the SFA output for second (A) and sixth (B) order polynomial expansion is plotted. 
As we change room to strongly elongated, the grids likewise become elongated as can be seen in fig. 6, in which the output of a simulation is shown for a room with a side-to-side ratio of 4 is shown.


## Applying ICA to the SFA output signals 
In fig. 7, we show the a subset of the output obtained after applying an additional independent component analysis to the first J (8, 48, 88, 108) SFA output signals. For a high number of SFA signals used, we obtain regions that are spatially very specific in low or high signal strength. The lower the number of used SFA output signals, the less pronounced the specificity of these areas.

## DISCUSSION
In this project we showed that SFA can produce similar spatial representations to those of grid cells and place cells found in the rodent hippocampus. 
Firstly, the higher order outputs of SFA showed periodic arrays covering the entire available environment similar to the representations of enthorinal grid cells. These results were robust to changes in sensor positioning, in that even using randomly distributed sensors produced these grid-like arrays. However, it important to note some important differences to the representations of grid cells. Firstly, the periodic arrays of the SFA output are not strictly triangular. As seen for example in Figure 5B, the SFA can also produce quadrangular and other types of grids. Furthermore, in strongly elongated rooms, the grids of the SFA likewise became elongated and did not cover the room evenly. It would be interesting to explore the SFA output changes with other environments such as more complicated shapes or environments filled with obstacles. 
Secondly, the performing ICA on top of SFA produced outputs that are high for only a small area of the environment and low for the rest. These representations are highly similar to those of hippocampal place cells. Importantly, these results were also robust to random sensor positioning. However, it is important to note that some of these representations are inverted in that they produce high outputs for the entire environment except for a small part, which does not correspond to experimentally found place cells. This, however, is a feature inherent in the ICA procedure, which does not determine the sign of the output uniquely.
Critically, while these results are very encouraging, they do not amount to a mechanistic explanation of how grid and place cells are computed in the brain. Providing experimental evidence for such a mechanistic explanation may prove to be difficult. It would probably involve using multiple recording sites upstream of the hippocampus to follow how exactly neural representations of navigationally relevant informations are changed along the dorsal processing stream. 
Another intriguing question is how these results would map to other sensory systems. Our simulations were loosely based on the echolocation of bats, which had the advantages that the input was low-dimensional and distance information was already explicit. Perhaps these results would therefore map relatively directly to the tactile whisker sensing of rodents, which is likewise relatively low dimensional (corresponding to the number of whiskers) and directly related to distance (whiskers are stimulated when they touch objects). Perhaps here SFA could also relatively easily produce grid-cell-like representations.
However, visual information is high-dimensional and distance information is not explicitly encoded. Therefore, it may be more difficult to use SFA to produce grid-cell-like representations on visual information. Distance information is hidden in visual input  in a multitude of clues including binocular disparity, binocular convergence, motion parallax, texture gradients and shading. Many preprocessing steps would be needed to extract this distance information and to reduce the dimensionality of the input. But in principle, once adequate preprocessing is achieved, SFA could produce grid-cell-like representations in an equivalent manner as in this project.
